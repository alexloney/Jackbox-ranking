version: "3.8"

services:
  pocketbase:
    image: ghcr.io/muchobien/pocketbase:latest
    container_name: jackbox_pb
    restart: unless-stopped
    command:
      - --encryptionEnv=PB_ENCRYPTION_KEY
    environment:
      PB_ENCRYPTION_KEY: "secret123"
    volumes:
      - ./pb_data:/pb/pb_data
    ports:
      - "8090:8090"

  webapp:
    image: node:18-alpine
    container_name: jackbox_web
    working_dir: /app
    # Mount your current directory directly into the container
    volumes:
      - ./:/app
    # Install http-server globally and run it
    command: sh -c "npm install -g http-server && http-server -p 3000 --cors"
    ports:
      - "3000:3000"
    depends_on:
      - pocketbase
